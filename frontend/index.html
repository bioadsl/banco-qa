
<!DOCTYPE html>
<html lang="pt-BR" ng-app="bancoApp" ng-controller="TransferenciaController">
<head>
  <meta charset="UTF-8">
  <title>Banco QA - Frontend Estático</title>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container py-5">
  <div class="row">
    <!-- Formulário de Transferência -->
    <div class="col-md-4">
      <div class="card shadow-sm mb-4">
        <div class="card-body">
          <h2 class="card-title text-center text-primary">Banco QA</h2>
          <p class="text-end fw-bold">
            Saldo: <span ng-class="saldo >= 0 ? 'text-success' : 'text-danger'">{{ saldo | currency:"R$" }}</span>
          </p>

          <form ng-submit="transferir()">
            <div class="mb-3">
              <label class="form-label">Cliente destino</label>
              <select class="form-select" ng-model="destino" ng-options="c.nome for c in contasFiltradas track by c.id">
                <option value="">Selecione o destinatário</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Valor</label>
              <input type="number" class="form-control" ng-model="valor" required step="0.01">
            </div>
            <div class="mb-3">
              <label class="form-label">Data de efetivação</label>
              <input type="date" class="form-control" ng-model="data" required>
            </div>
            <div class="d-flex justify-content-between">
              <button type="submit" class="btn btn-primary">Transferir</button>
              <button type="button" class="btn btn-secondary" ng-click="cancelar()">Cancelar</button>
            </div>
          </form>

          <p class="mt-3 text-center fw-bold text-success">{{ mensagem }}</p>
        </div>
      </div>
    </div>

    <!-- Extrato -->
    <div class="col-md-4">
      <div class="card shadow-sm mb-4">
        <div class="card-body">
          <h4 class="card-title text-center text-dark">Extrato</h4>
          <ul class="list-group">
            <li class="list-group-item" ng-repeat="t in extrato track by $index">
              <strong>{{ t.data }}</strong> — Transferido 
              <span class="text-danger">{{ t.valor | currency:"R$" }}</span> para 
              <strong>{{ t.destino }}</strong>
            </li>
            <li class="list-group-item text-muted" ng-if="extrato.length === 0">Nenhuma transação registrada.</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Painel do Gerente -->
    <div class="col-md-4">
      <div class="card shadow-sm">
        <div class="card-body">
          <h4 class="card-title text-center text-dark">Painel do Gerente</h4>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th>ID</th>
                <th>Nome</th>
                <th>Saldo</th>
              </tr>
            </thead>
            <tbody>
              <tr ng-repeat="conta in contas">
                <td>{{ conta.id }}</td>
                <td>{{ conta.nome }}</td>
                <td ng-class="conta.saldo >= 0 ? 'text-success' : 'text-danger'">
                  {{ conta.saldo | currency:"R$" }}
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
angular.module('bancoApp', [])
.controller('TransferenciaController', function($scope, $http) {
  const contaOrigemNome = 'Fabricio';
  $scope.saldo = 0;
  $scope.contas = [];
  $scope.contasFiltradas = [];
  $scope.extrato = [];

  $http.get('contas.json').then(function(response) {
    $scope.contas = response.data;
    const origem = $scope.contas.find(c => c.nome === contaOrigemNome);
    $scope.origem = origem;
    $scope.saldo = origem ? origem.saldo : 0;
    $scope.contasFiltradas = $scope.contas.filter(c => c.nome !== contaOrigemNome);
  });

  $scope.transferir = function() {
    if (!$scope.destino || !$scope.valor || !$scope.data) {
      $scope.mensagem = "Preencha todos os campos.";
      return;
    }

    if ($scope.valor > $scope.origem.saldo) {
      $scope.mensagem = "Saldo insuficiente.";
      return;
    }

    $scope.contas.forEach(c => {
      if (c.id === $scope.origem.id) c.saldo -= $scope.valor;
      if (c.id === $scope.destino.id) c.saldo += $scope.valor;
    });

    $scope.saldo = $scope.contas.find(c => c.nome === contaOrigemNome).saldo;

    $scope.extrato.unshift({
      destino: $scope.destino.nome,
      valor: $scope.valor,
      data: $scope.data
    });

    $scope.mensagem = "Transferência simulada com sucesso.";
  };

  $scope.cancelar = function() {
    $scope.valor = "";
    $scope.data = "";
    $scope.destino = "";
    $scope.mensagem = "";
  };
});
</script>

</body>
</html>
